# 项目设计文档

## 下厨房

### 项目背景描述

> *下厨房*美食菜谱网倡导在家烹饪、健康的生活方式,提供有版权的实用菜谱做法与饮食知识,提供厨师和美食爱好者一个记录、分享的平台

### 模块一：首页

![IMG_4582](IMG_4582.PNG)

#### 业务描述

- 推荐：系统每天抽取数据库浏览量最高的前几名的道菜的菜谱贴子

- 关注：按你关注的显示菜谱贴子

  

#### 前置条件

无     



### 模块二： 分类

![IMG_4586](IMG_4586.PNG)

#### 业务描述

按菜系，场景把菜谱分类

#### 前置条件

无

#### 流程图

#### 表设计

##### 分类表：T_CATEGORY

| CATEGORY_ID | CATEGORY_NAME |  LEVEL   | PID        | TAG     | TOPPED             | CREATE_TIME | LAST_UPDATE_TIME | CREATOR | LAST_REVISER |
| :---------: | :-----------: | :------: | ---------- | ------- | ------------------ | :---------: | :--------------: | ------- | ------------ |
|  自增主键   |   分类名称    | 分类等级 | 父分类的ID | 标签    | 是否置顶到首页主题 |  创建时间   |   最后修改时间   | 创建人  | 最后修改人   |
|   bigint    |    varchar    | tinyint  | tinyint    | varchar | char(1)            |  datetime   |     datetime     | bigint  | bigint       |

> 字段备注：
>
> 1. `LEVEL` 分类级别，比如==菜式==的LEVEL为1，==菜式==里面的**菜肴/主食/西点**的LEVEL为2
> 2. `PID`分类有多级，采用设计可以关联到上下级分类
> 3. `TAG`是分类的标签名称，用于首页的==主题==显示，比如**热门菜谱#本周流行#**
> 4. `TOPPED`是否置顶到首页，用于首页的 ==主题==显示，同时置顶的分类最多只能有==五==项

##### 食谱表：T_COOKBOOK
| COOKBOOK_ID | COOKBOOK_TITLE | DESCRIBE | MATERIAL | MEALS    | LIKE_COUNT | COLLECT_COUNT | CREATE_TIME | LAST_UPDATE_TIME | CREATOR | LAST_REVISER |
| ----------- | -------------- | -------- | -------- | -------- | ---------- | ------------- | ----------- | ---------------- | ------- | ------------ |
| 自增主键    | 食谱标题       | 描述     | 材料     | 所属三餐 | 点赞量     | 收藏量        | 创建时间    | 最后修改时间     | 创建人  | 最后修改人   |
| bigint      | varchar        | varchar  | varchar  | char(1)  | bigint     | biging        | datetime    | datetime         | bigint  | bigint       |

> 字段备注：
>
> 1. `DESCRIBE` 食谱标题下方的描述,有的食谱没有,就为空
> 2. `MATERIAL` 食谱的**需要材料**
> 4. `MEALS` 首页的分类**早餐**、**午餐**、**晚餐**、**夜宵**

##### 食谱分类表：T_COOKBOOK_CATEGORY


| ID       | COOKBOOK_ID | CATEGORY_ID |
| -------- | ----------- | ----------- |
| 自增主键 | 食谱ID      | 分类ID      |
| bigint   | bigint      | bigint      |

> 备注：一道食谱可能属于多个**分类**,一个**分类**同时也包含多个食谱

##### 步骤表：T_COOKBOOK_STEP

| STEP_ID  | COOKBOOK_ID | STEP_CONTENT |  STEP_IMAGE  | STEP_ORDER     |
| :------: | :---------: | :----------: | :----------: | -------------- |
| 自增主键 |  所属食谱   |   步骤描述   | 步骤图片路径 | 步骤，第几步骤 |
|  bigint  |   bigint    |   varchar    |   varchar    | bigint         |

> 一个步骤就是一条记录，一条记录有当前步骤的描述，和当前步骤的图片
>
> STEP_ORDER存储1，2，3....，代表当前记录是第几步骤

### 模块三：菜谱详情

![IMG_4584](IMG_4584.PNG)

#### 业务描述

3. 

#### 前置条件

进入分类





### 模块四：我的

![IMG_4585](IMG_4585.PNG)

#### 业务描述

进入我的

#### 前置条件

需要登录后

建表：

贴子详情表( tie_id(主键)  帖子图片 帖子标题   user_id(外键)  是否发布（0，1）  发布时间 ，推荐与否默认不推荐 价格默认0) ------表里写帖子的内容，收藏量通过收藏表分组得到，步骤在步骤表，未发布为0，放到草稿里显示

|  tie_id  |   tie_img    |  tie_title  |   user_id    |           tie_public            | tie_time |        tie_up        |   tie_price   |
| :------: | :----------: | :---------: | :----------: | :-----------------------------: | :------: | :------------------: | :-----------: |
| 自增主键 |   帖子图片   |  帖子标题   | 用户id(外键) | 是否发布(0,1未发布存草稿,默认0) | 发布时间 | 推荐与否(0,1 默认否) | 价格(默认为0) |
|   int    | varchar(200) | varchar(30) |     int      |               int               |   date   |         int          |    double     |

用料表（material_id(主键) tie_id(外键)  材料名 材料数量）

| material_id |    tie_id    | material_name | material_num |
| :---------: | :----------: | :-----------: | :----------: |
|  自增主键   | 帖子id(外键) |    材料名     |   材料用量   |
|     int     |     int      |  varchar(30)  | varchar(30)  |

步骤表（step_id(主键) tie_id(外键) 步骤描述 第几步）----写步骤   展示时---group by tie_id having tie_id=(xxx) order by 步骤；

| step_id  |    tie_id    | step_describe | step_num |
| :------: | :----------: | :-----------: | :------: |
| 自增主键 | 帖子id(外键) |   步骤描述    |  第几步  |
|   int    |     int      | varchar(255)  |   int    |

贴子分类表（classify_id(主键)  分类名)-----比如会员免费、进阶、减脂等等

| classify_id | classify_name |
| :---------: | :-----------: |
|  自增主键   |   类别名称    |
|     int     |  varchar(30)  |

帖子分类关系表(id(主键) classify_id(外键) tie_id(外键))-----一个帖子可以为不同的分类，同为减脂、会员免费等

|  ct_id   | classify_id  |    tie_id    |
| :------: | :----------: | :----------: |
| 自增主键 | 类别id(外键) | 帖子id(外键) |
|   int    |     int      |     int      |

评分表(score_id(主键)  user_id(外键) tie_id(外键) score评分)-----用户给不同帖子评分

| score_id |   user_id    |    tie_id    |        score         |
| :------: | :----------: | :----------: | :------------------: |
| 自增主键 | 用户id(外键) | 帖子id(外键) | 分数（约束只能0-10） |
|   int    |     int      |     int      |        double        |

贴子留言表(talk_id(主键) user_id tie_id(外键)  内容 时间) -----用户给不同帖子留言

| talk_id  | user_id | tie_id | talk_content | talk_time |
| -------- | ------- | ------ | ------------ | --------- |
| 自增主键 | 用户id  | 帖子id |              |           |
|          |         |        |              | datetime  |

收藏表（collect_id(主键) user_id(外键) tie_id(外键)）-----用户对不同的帖子点赞收藏

我的信息(user_id(主键) 头像图片(加默认图片)  用户名  性别  生日  职业 家乡 常居地 个人简介 用户等级(0,1,2,4 普通，vip，审核员，管理员）是否注销 )

关注表/粉丝表：（id(主键)  aid bid 时间）-----这张表意思是a关注b，查aid出关注的人，查bid出粉丝，粉丝量或关注量用分组计数得到



首页：------显示内容

1.关注：显示此用户，关注过的用户，发的帖子，按最新的时间（）

2.推荐：显示管理员推荐的贴子



课堂：------也是显示内容，通过分类显示

1 显示我的课程：我要学的课程

2 显示分类的贴子：

​    会员免费，显示出相应分类的贴子

​    进阶必看。。。

3 先选到别人的贴子，点击免费看

 或是选到别人的贴子，点击购买，



收藏：通过收藏表，通过自己的user_id查询出tie_id,然后显示内容



我的：

   设置：点进去设置个人信息

   关注：外面显示数量，点进去显示关注的用户名、头像

   粉丝：外面显示数量，点进去显示粉丝的用户名、头像









